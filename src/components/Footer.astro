---
import {getSiteConfig} from "../scripts/getSiteConfig";
import { execSync } from 'child_process';

const siteConfig = await getSiteConfig();

// Get build metadata at build time
let gitCommit = '';
let buildTime = new Date().toISOString();

try {
  // Get short git commit hash (7 characters)
  gitCommit = execSync('git rev-parse --short HEAD', { encoding: 'utf-8' }).trim();
  if (gitCommit || '' !== '') {
    gitCommit = ' â€¢ ' + gitCommit;
  }
} catch (error) {
  console.warn('Could not get git commit hash:', error);
}

// Format build time as a readable string
const buildDate = new Date(buildTime).toLocaleString('en-US', {
  year: 'numeric',
  month: 'short',
  day: 'numeric',
  hour: '2-digit',
  minute: '2-digit',
  timeZoneName: 'short'
});
---

<footer>
  {siteConfig.footer.content.map((item, _) => (
      <div class="page-footer">
        {item.replace('[CURRENT_YEAR]', new Date().getFullYear().toString())}
      </div>
  ))}

  <div class="page-footer">
    Built with <a href="https://astro.build" target="_blank" rel="noopener">Astro</a>.
  </div>

  <div class="page-footer build-info">
      ({buildDate}{gitCommit})
  </div>
</footer>
