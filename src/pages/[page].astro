---
import SitePageContent from '../components/SitePageContent.astro';
import {getSiteCode} from "../scripts/getSiteConfig.ts";


// Export getStaticPaths for static site generation
export async function getStaticPaths() {
  const siteCode = getSiteCode();

  // Dynamically discover all page content files in the assets directory
  const pageFiles = import.meta.glob('../assets/pagecontent/**');
  const siteCode = getSiteCode();
  // Extract the filename without extension to get the page slug
  // Filter to only include paths containing the current siteCode
  const pages = Object.keys(pageFiles)
    .filter(filePath => filePath.includes(`/pagecontent/${siteCode}/`))
    .map(filePath => {
      // Extract filename from path: ../assets/pagecontent/hiivelabs.com/about.astro -> about
      const filename = filePath.split('/').pop();
      const pageSlug = filename.replace(/\.(astro|mdx|md)$/, '');
      return pageSlug;
    });

  return pages.map(page => ({
    params: { page },
  }));
}

// Get the page slug from the URL
const { page } = Astro.params;

// Construct the current path
const current = `/${page}`;
---
<div class="top-bump" />
<SitePageContent file={page} current={current} />
